DROP TABLE IF EXISTS superstore_analytics_category;

CREATE TABLE superstore_analytics_category AS
SELECT
    category,
    CASE 
        WHEN discount = 0 THEN 'No Discount'
        WHEN discount BETWEEN 0.01 AND 0.20 THEN 'Low (1–20%)'
        WHEN discount BETWEEN 0.21 AND 0.40 THEN 'Medium (21–40%)'
        ELSE 'High (40%+)'
    END AS discount_band,
    SUM(sales)  AS total_sales,
    SUM(profit) AS total_profit
FROM superstore_clean
GROUP BY category, discount_band;
